<!DOCTYPE html>
<html>
<head>
  <style>
    body { background:black; margin:0; }
    video { width:100%; height:100vh; }
  </style>
</head>
<body>

<video id="videoPlayer" controls controlsList="nodownload"></video>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

fetch("/.netlify/functions/view?id=" + id)
  .then(res => {
    if (!res.ok) throw new Error();
    return res.json();
  })
  .then(data => {
    document.getElementById("videoPlayer").src = data.url;
  })
  .catch(() => {
    document.body.innerHTML = "<h1 style='color:white;text-align:center;margin-top:20%;'>Link Expired</h1>";
  });

document.addEventListener("contextmenu", e => e.preventDefault());
</script>

</body>
</html>

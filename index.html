<!DOCTYPE html>
<html>
<head>
  <title>Upload Video</title>
</head>
<body>

<h2>Upload Video with Expiry</h2>

<input type="file" id="videoFile"><br><br>
<input type="number" id="expiry" placeholder="Expiry in Minutes"><br><br>
<button onclick="uploadVideo()">Upload</button>

<p id="result"></p>

<script>
async function uploadVideo() {
  const file = document.getElementById("videoFile").files[0];
  const expiry = document.getElementById("expiry").value;

  if (!file || !expiry) {
    alert("Select file and expiry");
    return;
  }

  const res = await fetch("/.netlify/functions/upload", {
    method: "POST",
    body: JSON.stringify({
      filename: file.name,
      expiryMinutes: expiry
    })
  });

  const data = await res.json();

  await fetch(data.uploadUrl, {
    method: "PUT",
    headers: {
      "Content-Type": file.type
    },
    body: file
  });

  document.getElementById("result").innerHTML =
    "Video Link: <a href='player.html?id=" + data.id + "' target='_blank'>Open Player</a>";
}
</script>

</body>
</html>
